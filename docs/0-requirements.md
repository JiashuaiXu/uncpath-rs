# UNC路径转换工具分阶段开发需求

## 项目定位

打造基于 `uncpath-py` 的高内聚、低耦合、支持 XDG 配置的 TUI/CLI 工具，实现 Windows/SMB UNC 路径到 Linux 本地路径的智能映射、跳转与批量管理。易于扩展、维护，无过度工程，极致聚焦开发者体验及自动化脚本集成。

---

## 阶段一（MVP）：TUI路径映射与跳转 (`unc`)

- **启动命令**：`unc`（支持 `--help / -h` 与 `--version / -v`）
- **配置文件**：YAML 格式，严格按 XDG 路径（优先 `${XDG_CONFIG_HOME}/uncpath/config.yaml`，备份到 `~/.config/uncpath/config.yaml`），映射为“UNC前缀 -> 本地路径”
- **核心解析**：
    - 支持 `\\host\share\foo`，`//host/share/foo`，`smb://host/share/foo` 三格式自动标准化
    - 输入任何UNC路径，动态查找所有配置前缀，使用**最长匹配前缀**，剩余部分拼接到本地路径，得到目标结果
- **TUI管理**：
    - 输入一栏、映射管理一栏、标准化+拼接结果一栏
    - 实时配置增删改查、热生效
    - 跳转功能（可直接cd、本地路径预览）
    - 错误高亮与详细报错
- **弹性设计**：路径拆分/标准化/拼接/前缀查找代码可独立单测

---

## 阶段二：补全与智能路径发现（`uncdir`/TUI增强）

- **Samba 配置智能解析**：
    - 自动解析本机`/etc/samba/smb.conf`，检索全部Samba共享名
    - 自动获取本机所有局域网IP（适配多网卡），拼接 Samba 共享路径
    - 支持 YAML 配置 `host_overrides` 字段，自定义主机 ip/别名

- **局域网共享枚举与路径补全**：
    - 命令 `uncdir`：在 CLI 或 TUI 下，基于 smb.conf 与配置的 IP/主机名，生成/打印所有真实的局域网下可直连的 Samba 路径（如 `\\192.168.10.172\sambaShare\`）
    - 支持参数控制（只输出拼接、可选动态实际发现，允许扩展 nmblookup/smbclient）
    - 动态扫描局域网主机/网段下所有 Samba 路径，可一键导入为映射
    - 联动 TUI 补全，输入时路径支持基于本地目录、实际网络共享和历史常用进行交互补全，推荐快速跳转选项
    - 支持输出模式与静态快速扫描分离（适合脚本批量操作）

---

## 阶段三：uncli——CLI一行交互模式

- **命令行工具**：`uncli` （支持 `--help / -h`，`--version / -v`）
- **核心体验**：
    - 启动后单行提示输入 UNC 路径或关键字，输入支持与 TUI 一致的补全/标准化/最长前缀映射能力
    - 用户按回车直接输出本地实际物理路径，不切换目录
    - 可链式处理（接收 pipe/batch）
    - 可脚本集成用作如 `cd $(uncli <片段>)`
    - 交互回显与异常报错要简明清晰

---

## 阶段四：uncd——终极 CLI 跳转模式

- **命令行工具**：`uncd <UNC路径或片段>` （支持 `--help / -h`，`--version / -v`）
    - 支持模糊查询与自动补全，自动做前缀查找、映射拼接，直接切换目录（或 echo 物理路径）
    - 可与 shell alias 深度绑定，如 `cd $(uncd ...)` 一步切换
    - 全部自动化，零交互（交互补全可选，失败时报错、歧义时提示）
    - 同步支持静态与动态 SMB 网络发现、配置兼容

---

## 设计原则

- 所有路径映射与转换算法、配置IO、TUI逻辑、CLI流程模块化、分层互不干扰
- 映射表/标准化/最长前缀查找实现为无副作用纯函数
- 配置热加载、支持多主机多网卡复杂网络、可独立扩展
- 边界/异常分层输出、错误码覆盖完整

---

## 示例配置（`config.yaml`）

```yaml
mappings:
  "192.168.10.172/sambaShare": "/opt/samba"
  "fileserver/docs": "/mnt/smb/docs"
host_overrides:
  - "192.168.10.100"
  - "host-alias"
defaults:
  base_path: "/mnt/smb"
  auto_create: true
```$

